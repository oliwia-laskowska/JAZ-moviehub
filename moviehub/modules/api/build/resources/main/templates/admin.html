<!doctype html>
<html lang="pl" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Admin - MovieHub</title>
    <style>
        body { font-family: system-ui; padding: 24px; max-width: 980px; margin: 0 auto; }
        .row { display:flex; gap:12px; align-items:center; flex-wrap: wrap; }
        .card { border: 1px solid #ddd; padding: 16px; border-radius: 12px; margin: 12px 0; }
        button { padding: 10px 14px; border-radius: 10px; border: 1px solid #333; background: #111; color: #fff; cursor:pointer; }
        a { color: #111; }
        code { background:#f3f3f3; padding:2px 6px; border-radius:6px; }
        .flash { margin-top:12px; color: green; }
        .muted { color:#666; }
        .grid { display:grid; grid-template-columns: 220px 1fr; gap: 6px 16px; margin-top: 10px; }
    </style>
</head>
<body>

<h1>Panel administratora</h1>

<div th:if="${syncMessage}" class="flash">
    <b th:text="${syncMessage}"></b>
</div>

<div class="card">
    <div class="row">
        <div><b>Liczba filmów:</b> <span th:text="${moviesCount}">0</span></div>

        <form th:action="@{/admin/sync}" method="post" style="margin:0;">
            <button type="submit">SYNC (pobierz dane z internetu)</button>
        </form>

        <form th:action="@{/logout}" method="post" style="margin:0;">
            <button type="submit" style="background:#444;border-color:#444;">Wyloguj</button>
        </form>
    </div>

    <div style="margin-top:12px;">
        <b>Ostatnia aktualizacja:</b>
        <span th:if="${lastRun != null}"
              th:text="${#temporals.format(lastRun.runAt, 'yyyy-MM-dd HH:mm:ss')}">—</span>
        <span th:unless="${lastRun != null}" class="muted">brak</span>
    </div>

    <div th:if="${lastRun != null}" class="grid">
        <div><b>Upserts</b></div><div th:text="${lastRun.upserts}">0</div>
        <div><b>Kto uruchomił</b></div><div th:text="${lastRun.triggeredBy}">—</div>
        <div><b>Źródło</b></div><div th:text="${lastRun.source}">UI</div>
    </div>

    <p style="margin-top:12px;">
        Logi API:
        <a th:href="${logsUrl}" target="_blank" rel="noreferrer">Otwórz</a>
        &nbsp;|&nbsp;
        <code th:text="${logsUrl}">/api/admin/logs?lines=200</code>
    </p>
</div>

<p>
    <a th:href="@{/}">← Strona główna</a>
</p>

</body>
</html>
